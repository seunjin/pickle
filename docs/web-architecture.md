# apps/web ì•„í‚¤í…ì²˜ ê°€ì´ë“œ (FSD-lite)

ì´ ë¬¸ì„œëŠ” `apps/web` (Next.js App Router) í”„ë¡œì íŠ¸ì˜ í´ë” êµ¬ì¡°ì™€ ì•„í‚¤í…ì²˜ ê·œì¹™ì„ ì„¤ëª…í•©ë‹ˆë‹¤.
ìš°ë¦¬ëŠ” ë³µì¡ì„±ì„ ì¤„ì´ê³  ìœ ì§€ë³´ìˆ˜ì„±ì„ ë†’ì´ê¸° ìœ„í•´ **FSD(Feature-Sliced Design)ì˜ ê²½ëŸ‰í™” ë²„ì „(FSD-lite)**ì„ ì±„íƒí–ˆìŠµë‹ˆë‹¤.

## 1. ìƒìœ„ ë ˆë²¨ êµ¬ì¡° (High-Level Structure)

`src` í´ë”ëŠ” í¬ê²Œ ì„¸ ê°€ì§€ ê³„ì¸µìœ¼ë¡œ ë‚˜ë‰©ë‹ˆë‹¤.

```bash
apps/web/src/
â”œâ”€â”€ app/        # ë¼ìš°íŒ… ë° ë ˆì´ì•„ì›ƒ (Routing & Layouts)
â”œâ”€â”€ features/   # ë¹„ì¦ˆë‹ˆìŠ¤ ê¸°ëŠ¥ ìŠ¬ë¼ì´ìŠ¤ (Feature Slices)
â””â”€â”€ shared/     # ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë²”ìš© ì½”ë“œ (Reusable Primitives)
```

---

## 2. ê³„ì¸µë³„ ì—­í•  ë° ê·œì¹™

### ğŸŸ§ App Layer (`src/app`)
Next.jsì˜ App Routerê°€ ìœ„ì¹˜í•˜ëŠ” ê³³ì…ë‹ˆë‹¤.

*   **ì—­í• **: URL ë¼ìš°íŒ…, í˜ì´ì§€ ë ˆì´ì•„ì›ƒ, ê·¸ë¦¬ê³  ê¸°ëŠ¥(Feature)ë“¤ì˜ ì¡°ë¦½(Composition).
*   **ê·œì¹™**:
    *   **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê¸ˆì§€**: í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ëŠ” ìµœëŒ€í•œ ì–‡ê²Œ ìœ ì§€í•˜ë©°, ë¡œì§ì€ `features`ë¡œ ìœ„ì„í•©ë‹ˆë‹¤.
    *   **Direct DB ì ‘ê·¼ ê¸ˆì§€ (UI Layer)**: UI ì»´í¬ë„ŒíŠ¸ë‚˜ í˜ì´ì§€ì—ì„œ Supabaseë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
    *   **Import**: `features/**`ì˜ Public API(`index.ts`)ë¥¼ í†µí•´ì„œë§Œ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.

### ğŸŸ© Features Layer (`src/features`)
ì‚¬ìš©ìì—ê²Œ ê°€ì¹˜ë¥¼ ì œê³µí•˜ëŠ” **ê¸°ëŠ¥ ë‹¨ìœ„(Slice)**ë“¤ì´ ìœ„ì¹˜í•˜ëŠ” í•µì‹¬ ì˜ì—­ì…ë‹ˆë‹¤.
ì˜ˆ: `auth`, `workspace`, `notes`...

ê° ê¸°ëŠ¥ í´ë”ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‚´ë¶€ êµ¬ì¡°ë¥¼ ê°€ì§‘ë‹ˆë‹¤:

```bash
src/features/<feature-name>/
â”œâ”€â”€ api/      # ì„œë²„ ì•¡ì…˜, Supabase ì¿¼ë¦¬/ë®¤í…Œì´ì…˜
â”œâ”€â”€ model/    # ë¡œì»¬ ìƒíƒœ, Zod ìŠ¤í‚¤ë§ˆ, ì»¤ìŠ¤í…€ í›…, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”œâ”€â”€ ui/       # í•´ë‹¹ ê¸°ëŠ¥ì˜ UI ì»´í¬ë„ŒíŠ¸ (Forms, Lists, Cards...)
â””â”€â”€ index.ts  # ì™¸ë¶€ ê³µê°œ API (Public Exports)
```

*   **ê·œì¹™**:
    *   **Deep Import ê¶Œì¥**: í•„ìš”í•œ ëª¨ë“ˆì˜ ì •í™•í•œ íŒŒì¼ ê²½ë¡œë¥¼ ì§ì ‘ ëª…ì‹œí•˜ì—¬ ê°€ì ¸ì˜µë‹ˆë‹¤. (`CONVENTIONS.md` 4.6 ì°¸ì¡°)
      - âœ… Good: `import { getNotes } from \"@/features/note/api/getNotes\"`
      - âŒ Bad: `import { getNotes } from \"@/features/note\"`
    *   **Barrel File ì§€ì–‘**: `index.ts`ë¥¼ í†µí•´ ëª¨ì•„ì„œ ë‚´ë³´ë‚´ëŠ” ë°©ì‹ì„ ì§€ì–‘í•©ë‹ˆë‹¤. (ìˆœí™˜ ì°¸ì¡° ë°©ì§€, Tree Shaking ìµœì í™”)
    *   **Supabase ì ‘ê·¼**: ì˜¤ì§ `api/` í´ë” ë‚´ë¶€ì—ì„œë§Œ Supabase í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜ ë°ì´í„°ë¥¼ ìš”ì²­í•´ì•¼ í•©ë‹ˆë‹¤.

### ğŸŸ¦ Shared Layer (`src/shared`)
ë„ë©”ì¸(ë¹„ì¦ˆë‹ˆìŠ¤) ì§€ì‹ì´ ì—†ëŠ”, í”„ë¡œì íŠ¸ ì „ë°˜ì—ì„œ ì¬ì‚¬ìš©ë˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

```bash
src/shared/
â”œâ”€â”€ ui/       # @pickle/ui ë“±ì˜ ë˜í¼ ë˜ëŠ” ë²”ìš© UI ì»´í¬ë„ŒíŠ¸
â”œâ”€â”€ lib/      # ìœ í‹¸ë¦¬í‹° (supabase client, fetcher, dateFormatter ë“±)
â”œâ”€â”€ config/   # ìƒìˆ˜, í™˜ê²½ë³€ìˆ˜ ì„¤ì •
â””â”€â”€ styles/   # ì „ì—­ ìŠ¤íƒ€ì¼
```

*   **ê·œì¹™**:
    *   **ë„ë©”ì¸ ìš©ì–´ ì‚¬ìš© ê¸ˆì§€**: `WorkspaceCard`, `UserTable` ê°™ì€ ì´ë¦„ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. `Card`, `Table` ì²˜ëŸ¼ ë²”ìš©ì ì´ì–´ì•¼ í•©ë‹ˆë‹¤.
    *   íŠ¹ì • ê¸°ëŠ¥ì— ì¢…ì†ëœ ì½”ë“œëŠ” `features`ë¡œ ì´ë™ì‹œì¼œì•¼ í•©ë‹ˆë‹¤.

---

## 3. ê°œë°œ ì›Œí¬í”Œë¡œìš° ì˜ˆì‹œ (Example Workflow)

ìƒˆë¡œìš´ ê¸°ëŠ¥ì¸ "ëŒ“ê¸€(Comments)" ê¸°ëŠ¥ì„ ë§Œë“ ë‹¤ê³  ê°€ì •í•´ ë´…ì‹œë‹¤.

1.  **í´ë” ìƒì„±**: `src/features/comments` í´ë”ë¥¼ ë§Œë“­ë‹ˆë‹¤.
2.  **ë°ì´í„° ë¡œì§ (`api/`)**: `src/features/comments/api/actions.ts`ë¥¼ ë§Œë“¤ê³  Supabaseì—ì„œ ëŒ“ê¸€ì„ ê°€ì ¸ì˜¤ê±°ë‚˜ ì‘ì„±í•˜ëŠ” Server Actionì„ êµ¬í˜„í•©ë‹ˆë‹¤.
3.  **ìƒíƒœ/ë¡œì§ (`model/`)**: í•„ìš”í•œ ê²½ìš° `useCommentStore`ë‚˜ ëŒ“ê¸€ ì…ë ¥ í¼ ê²€ì¦ì„ ìœ„í•œ Zod ìŠ¤í‚¤ë§ˆë¥¼ `src/features/comments/model/`ì— ì‘ì„±í•©ë‹ˆë‹¤.
4.  **UI êµ¬í˜„ (`ui/`)**: `CommentList.tsx`, `CommentForm.tsx`ë¥¼ `src/features/comments/ui/`ì— êµ¬í˜„í•©ë‹ˆë‹¤.
5.  **ê³µê°œ (`index.ts`)**: `src/features/comments/index.ts`ì—ì„œ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸(ì˜ˆ: `CommentSection`)ë§Œ export í•©ë‹ˆë‹¤.
6.  **í˜ì´ì§€ ì¡°ë¦½ (`app/`)**: `src/app/notes/[id]/page.tsx`ì—ì„œ `<CommentSection />`ì„ import í•˜ì—¬ ë°°ì¹˜í•©ë‹ˆë‹¤.

---

## 4. ëª¨ë…¸ë ˆí¬ íŒ¨í‚¤ì§€ í™œìš© (External Packages)

`apps/web`ì€ monorepo ë‚´ë¶€ì˜ íŒ¨í‚¤ì§€ë“¤ì„ ì ê·¹ í™œìš©í•˜ì—¬ ì¤‘ë³µì„ ì¤„ì…ë‹ˆë‹¤.

### ğŸ“¦ `@pickle/contracts` (Data Contracts)
*   **ì—­í• **: Webê³¼ Extensionì´ ê³µìœ í•˜ëŠ” **ë°ì´í„° íƒ€ì…, Zod ìŠ¤í‚¤ë§ˆ, DTO**ì˜ ë‹¨ì¼ ì§„ì‹¤ ê³µê¸‰ì›(SSOT).
*   **ê·œì¹™**:
    *   API ì‘ë‹µ íƒ€ì…ì´ë‚˜ ê³µìš© ë„ë©”ì¸ ëª¨ë¸(User, Note ë“±)ì€ ì—¬ê¸°ì„œ ì •ì˜í•˜ê³  import í•´ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤.
    *   `src/features/<feature>/model`ì—ì„œ ì¬ì •ì˜í•˜ì§€ ì•Šê³  contractsë¥¼ í™•ì¥í•˜ê±°ë‚˜ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.

### ğŸ¨ `@pickle/ui` (Design System)
*   **ì—­í• **: shadcn/ui ê¸°ë°˜ì˜ **ì›ì ë‹¨ìœ„ UI ì»´í¬ë„ŒíŠ¸** (Button, Input, Dialog ë“±).
*   **ê·œì¹™**:
    *   `src/shared/ui`ëŠ” ì´ íŒ¨í‚¤ì§€ì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ë˜í•‘í•˜ê±°ë‚˜ ì¡°í•©í•˜ëŠ” ìš©ë„ë¡œë§Œ ì‚¬ìš©í•©ë‹ˆë‹¤.
    *   ì§ì ‘ ìŠ¤íƒ€ì¼ë§ì„ ìˆ˜ì •í•˜ê¸°ë³´ë‹¤ `@pickle/ui`ì˜ ë³€í˜•(Variants)ì„ í™œìš©í•©ë‹ˆë‹¤.

