# 📋 Pickle 기능 명세서 (Feature Specification)

이 문서는 Pickle 서비스의 모든 기능을 상세히 명세합니다. PRD 및 기획 문서 작성 시 참고 자료로 활용됩니다.

---

## 1. 인증 및 계정 (Authentication & Account)

### 1.1 회원가입 (Sign Up)

| 항목 | 상세 |
|:---|:---|
| **진입점** | 랜딩 페이지 → "시작하기" 버튼 |
| **인증 방식** | Google OAuth 2.0 (PKCE) |
| **필수 동의** | 서비스 이용약관, 개인정보 처리방침 |
| **선택 동의** | 마케팅 정보 수신 동의 |
| **가입 완료 시** | 기본 워크스페이스 자동 생성, `active` 상태로 전환 |

**가입 플로우:**
```
1. 사용자: "시작하기" 클릭
2. 시스템: 약관 동의 페이지 표시
   - [필수] 서비스 이용약관
   - [필수] 개인정보 처리방침
   - [선택] 마케팅 정보 수신
3. 사용자: 필수 약관 동의 후 "동의하고 계속하기" 클릭
4. 시스템: Google 로그인 팝업 노출
5. 사용자: Google 계정 선택 및 인증
6. 시스템: 계정 생성, 기본 워크스페이스 생성, 대시보드로 이동
```

### 1.2 로그인 (Sign In)

| 항목 | 상세 |
|:---|:---|
| **진입점** | 랜딩 페이지 → "로그인" 버튼, 익스텐션 팝업 |
| **인증 방식** | Google OAuth 2.0 |
| **세션 유지** | 자동 갱신 (Access Token 만료 5분 전 Silent Refresh) |

**익스텐션 세션 동기화:**
- 익스텐션 로그인 → 웹 대시보드 자동 로그인 (쿠키 동기화)
- 웹 로그아웃 → 익스텐션 세션 유지 (독립적)

### 1.3 로그아웃 (Sign Out)

| 항목 | 상세 |
|:---|:---|
| **진입점** | 웹: 사이드바 프로필 → 로그아웃, 익스텐션: 팝업 메뉴 |
| **동작** | 로컬 세션 삭제, 랜딩 페이지로 이동 |

### 1.4 회원탈퇴 (Account Deletion)

| 항목 | 상세 |
|:---|:---|
| **진입점** | 설정 페이지 → 계정 관리 → 회원탈퇴 |
| **확인 절차** | 탈퇴 경고 문구 표시, 최종 확인 버튼 |
| **삭제 범위** | 계정 정보, 모든 노트, 태그, 폴더, 업로드 파일 |
| **삭제 방식** | 즉시 영구 삭제 (Cascade Delete) |
| **복구 가능 여부** | 불가능 |

---

## 2. 콘텐츠 저장 (Content Saving) - 익스텐션

### 2.1 텍스트 저장 (Text Capture)

| 항목 | 상세 |
|:---|:---|
| **트리거** | 텍스트 선택 후 단축키 입력 |
| **기본 단축키** | `Ctrl+N` (Windows), `Cmd+N` (Mac) |
| **저장 데이터** | 선택 텍스트, 원본 URL, 페이지 메타데이터 |
| **UI 피드백** | 오버레이 팝업 (저장 완료 토스트) |

**저장 시 수집 데이터:**
- `text`: 선택된 텍스트 내용
- `url`: 현재 페이지 URL
- `meta.title`: 페이지 제목
- `meta.favicon`: 파비콘 URL
- `meta.site_name`: 사이트명
- `meta.description`: 페이지 설명

### 2.2 이미지 저장 (Image Save)

| 항목 | 상세 |
|:---|:---|
| **트리거** | 이미지 우클릭 → Pickle → 이미지 저장하기 |
| **기본 단축키** | - (미지원) |
| **저장 데이터** | 이미지 파일, 원본 URL, 페이지 메타데이터 |
| **멀티 프레임 지원** | iframe 내 이미지도 저장 가능 |

**저장 흐름:**
1. 사용자: 이미지 위에 마우스 호버
2. 익스텐션: 호버 상태를 백그라운드 캐시에 저장
3. 사용자: 이미지 우클릭 → "이미지 저장하기" 클릭
4. 익스텐션: 캐시된 이미지 정보로 저장 실행
5. 시스템: 이미지 파일 업로드 → Asset 생성 → Note 생성

### 2.3 화면 캡처 (Screen Capture)

| 항목 | 상세 |
|:---|:---|
| **트리거** | 단축키 입력 후 영역 드래그 |
| **기본 단축키** | `Ctrl+E` (Windows), `Cmd+E` (Mac) |
| **저장 데이터** | 캡처 이미지, 캡처 영역 크기, 원본 URL |
| **UI** | 오버레이로 영역 선택 가이드 표시 |

**캡처 흐름:**
1. 사용자: 단축키 입력
2. 익스텐션: 화면에 캡처 오버레이 표시
3. 사용자: 드래그로 영역 선택
4. 익스텐션: 선택 영역 캡처 → 이미지 생성
5. 시스템: 이미지 업로드 → Asset 생성 → Note 생성 (display_width, display_height 포함)

### 2.4 북마크 저장 (Bookmark)

| 항목 | 상세 |
|:---|:---|
| **트리거** | 페이지에서 단축키 입력 (텍스트/이미지 선택 없이) |
| **기본 단축키** | `Ctrl+B` (Windows), `Cmd+B` (Mac) |
| **저장 데이터** | URL, OG 메타데이터 (제목, 설명, 이미지, 파비콘) |

**메타데이터 수집:**
- `og:title` → `meta.title`
- `og:description` → `meta.description`
- `og:image` → `meta.image`
- `link[rel="icon"]` → `meta.favicon`
- `og:site_name` → `meta.site_name`

---

## 3. 콘텐츠 관리 (Content Management) - 웹 대시보드

### 3.1 대시보드 (Dashboard)

| 항목 | 상세 |
|:---|:---|
| **URL** | `/dashboard` |
| **기본 뷰** | 그리드 레이아웃, 최신순 정렬 |
| **페이지네이션** | 무한 스크롤 |
| **필터 옵션** | 노트 유형, 태그, 날짜 범위 |
| **정렬 옵션** | 최신순, 오래된순 |

**노트 카드 표시 정보:**
- 노트 유형 아이콘
- 썸네일 또는 프리뷰 (이미지/캡처/북마크)
- 제목 (사용자 지정 또는 메타 타이틀)
- 메모 (있는 경우)
- 태그 목록
- 생성 일시
- 원본 사이트 파비콘

### 3.2 노트 상세/편집 (Note Detail)

| 항목 | 상세 |
|:---|:---|
| **진입** | 노트 카드 클릭 |
| **UI** | 모달 또는 사이드 패널 |
| **편집 가능 항목** | 제목, 메모, 태그, URL |
| **삭제** | 휴지통으로 이동 (Soft Delete) |
| **북마크 토글** | 중요 노트 표시 |

### 3.3 검색 (Search)

| 항목 | 상세 |
|:---|:---|
| **URL** | `/search` |
| **검색 대상** | 제목, 메모, URL, 태그, 텍스트 내용 |
| **검색 방식** | 전문 검색 (Full-text Search) |
| **필터 연동** | 노트 유형, 태그와 조합 검색 가능 |

### 3.4 북마크 모음 (Bookmarks)

| 항목 | 상세 |
|:---|:---|
| **URL** | `/bookmarks` |
| **표시 대상** | `bookmarked_at`이 설정된 노트 |
| **정렬** | 북마크 추가 일시순 |

### 3.5 휴지통 (Trash)

| 항목 | 상세 |
|:---|:---|
| **URL** | `/trash` |
| **표시 대상** | `deleted_at`이 설정된 노트 |
| **복구** | `deleted_at`을 null로 변경 |
| **영구 삭제** | DB 및 Storage에서 완전 삭제 |
| **자동 삭제** | (향후) 30일 후 자동 영구 삭제 예정 |

### 3.6 태그 관리 (Tags)

| 항목 | 상세 |
|:---|:---|
| **태그 생성** | 노트 편집 시 인라인 생성 |
| **태그 목록** | 사이드바에 전체 태그 표시 |
| **태그 삭제** | 태그 관리 UI에서 삭제 (연결된 노트는 유지) |

### 3.7 폴더 관리 (Folders)

| 항목 | 상세 |
|:---|:---|
| **폴더 생성** | 사이드바 "새 폴더" 버튼 |
| **폴더 계층** | 단일 계층 (중첩 불가) |
| **노트 이동** | 드래그 앤 드롭 또는 노트 편집에서 선택 |
| **폴더 삭제** | 폴더 삭제 시 내부 노트는 미분류로 이동 |

---

## 4. 설정 (Settings)

### 4.1 프로필 설정

| 항목 | 상세 |
|:---|:---|
| **URL** | `/settings` |
| **변경 가능** | 이름, 프로필 사진 |
| **변경 불가** | 이메일 (Google 계정 연동) |

### 4.2 알림 설정

| 항목 | 상세 |
|:---|:---|
| **마케팅 수신** | 이메일 수신 동의 on/off |

### 4.3 단축키 설정 (익스텐션)

| 항목 | 상세 |
|:---|:---|
| **위치** | 익스텐션 설정 페이지 |
| **커스터마이징** | 저장 단축키 변경 가능 |
| **기본값 복원** | 모든 단축키 기본값으로 리셋 |

---

## 5. 스토리지 관리 (Storage)

### 5.1 용량 표시

| 항목 | 상세 |
|:---|:---|
| **위치** | 사이드바 하단, 설정 페이지 |
| **표시 형식** | 사용량/한도 (예: 25.3MB / 50MB) |
| **경고 표시** | 90% 이상 사용 시 강조 색상 |

### 5.2 용량 계산 범위

| 데이터 | 포함 여부 |
|:---|:---|
| 이미지/캡처 파일 | ✅ |
| 텍스트 노트 데이터 | ✅ |
| 북마크 메타데이터 | ✅ |
| 태그, 폴더 메타데이터 | ❌ (미미함) |

### 5.3 용량 초과 시 동작

- 저장 시도 전 잔여 용량 체크
- 용량 초과 예상 시 저장 차단
- 사용자에게 "스토리지 용량 부족" 알림
- 기존 노트 삭제 또는 유료 확장 안내 (향후)

---

## 6. 에러 처리 및 사용자 피드백

### 6.1 토스트 알림

| 유형 | 예시 |
|:---|:---|
| 성공 | "노트가 저장되었습니다" |
| 경고 | "스토리지 용량이 90%를 초과했습니다" |
| 에러 | "저장에 실패했습니다. 다시 시도해주세요" |

### 6.2 에러 페이지

| 상황 | 표시 내용 |
|:---|:---|
| 404 | 페이지를 찾을 수 없습니다 |
| 500 | 서버 오류가 발생했습니다 |
| 네트워크 오류 | 인터넷 연결을 확인해주세요 |
| 세션 만료 | 다시 로그인해주세요 |

---

## 7. 접근성 및 반응형

### 7.1 반응형 디자인

| 브레이크포인트 | 레이아웃 |
|:---|:---|
| Desktop (1024px+) | 사이드바 + 메인 콘텐츠 |
| Tablet (768px-1023px) | 축소된 사이드바 |
| Mobile (767px-) | 하단 네비게이션 (향후) |

### 7.2 접근성

- 키보드 네비게이션 지원
- 스크린 리더 호환 (aria-label)
- 고대비 색상 사용 (다크모드 포함)

---

*이 문서는 PRD 작성을 위한 기능 명세 보조 자료입니다.*
