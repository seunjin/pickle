# UX 히스토리 관리 정책 (Search & Filter)

이 문서는 사용자가 서비스 내에서 검색 및 필터링을 수행할 때 브라우저 히스토리를 관리하는 표준 정책을 정의합니다.

## 1. 기본 원칙 (Core Principle)

사용자가 **뒤로가기(Back)** 버튼을 눌렀을 때, 개별 필터 클릭 단계가 아닌 **"의미 있는 이전 페이지"**로 돌아가야 합니다. 이를 통해 "뒤로가기 함정(History Pollution)"을 방지합니다.

---

## 2. Push vs Replace 가이드라인

### 2.1 `router.replace`를 사용하는 경우 (추천)
현재 페이지의 컨텍스트(Context)를 유지한 상태에서 **조회 조건만 변경**될 때 사용합니다.

- **대상**: 
    - 필터 변경 (타입, 폴더, 태그 등)
    - 정렬 순서 변경 (최신순, 오래된순)
    - 페이지네이션 (단, 무한 스크롤이 아닌 일반 페이지 이동일 경우)
- **효과**: URL은 업데이트되어 공유가 가능하지만, 히스토리 스택에는 쌓이지 않습니다. 사용자가 필터를 10번 바꿔도 뒤로가기 1번으로 이전 화면(예: 대시보드)으로 돌아갑니다.

### 2.2 `router.push`를 사용하는 경우
사용자가 **새로운 탐색(Navigation)을 시작**했다고 판단될 때 사용합니다.

- **대상**:
    - 검색창에 새로운 검색어를 입력하고 엔터를 눌러 검색을 시작할 때
    - 완전히 다른 카테고리로 이동할 때
- **효과**: 새로운 히스토리가 기록됩니다. 사용자가 "사과"를 검색한 뒤 "포도"를 검색했다면, 뒤로가기를 눌러 "사과" 검색 결과로 돌아갈 수 있습니다.

---

## 3. 구현 세부 사항 (Next.js)

### 옵션 설정
- **`scroll: false`**: 필터 변경 시 페이지 최상단으로 자동 스크롤되는 것을 방지하기 위해 반드시 설정합니다.

### 코드 예시
```typescript
// ✅ Good: 필터 변경 시 사용자 경험 최적화
router.replace(`/search?type=image`, { scroll: false });

// ❌ Bad: 뒤로가기 함정 발생
router.push(`/search?type=image`);
```

---

## 4. 기대 효과
1. **뒤로가기 최적화**: 사용자가 원하는 이전 페이지로 즉시 이동 가능.
2. **상태 보존**: URL에 상태가 반영되므로 새로고침이나 링크 공유 시에도 동일한 필터링 결과 보장.
3. **부드러운 전환**: `{ scroll: false }`를 통해 UI 깜빡임이나 불필요한 스크롤 이동 최소화.
