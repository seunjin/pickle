본 문서는 서비스의 권한 체계를 **플랫폼 권한(Platform Authority)**, **사용자 상태(User State)**, **워크스페이스 역할(Workspace Role)** 로 분리하여 정의한다.

세 체계는 서로 독립적이며, **서로 간의 상하 관계로 직접 비교하지 않는다.**

(예: workspace owner는 특정 워크스페이스의 최고 권한이며, platform super_admin은 플랫폼 운영 권한이다.)

---

## **1. 권한 체계 정의**

### **1.1 Platform Authority (플랫폼 운영 권한)**

플랫폼 운영 및 관리 목적의 권한 체계이다.

- **super_admin**: 플랫폼 최고 운영 권한
- **admin**: 플랫폼 운영 권한

> 대부분의 일반 사용자는 Platform Authority가 없다. (즉, null/none)

### **1.2 User State (사용자 계정 상태)**

사용자의 “서비스 이용 가능 여부/제한 여부”를 나타내는 상태 체계이다.

- **guest**: 로그인하지 않은 방문자 상태
- **pending**: 로그인은 했으나, 약관 동의 등 가입 절차를 완료하지 않은 상태 (서비스 이용 불가)
- **active** (기존 member): 가입이 완료되어 정상적으로 서비스를 이용할 수 있는 상태
- **suspended**: 부적절한 사용으로 인해 일시적으로 이용이 제한된 상태
- **deleted**: 탈퇴 처리된 상태

### **1.3 Workspace Role (워크스페이스 내 역할)**

워크스페이스 단위의 협업/권한 체계이다.

- **owner**: 해당 워크스페이스의 최고 권한자
- **member**: 해당 워크스페이스의 일반 구성원

---

## **2. 우선 적용 원칙 (충돌 시 규칙)**

### **2.1 상태 우선 원칙**

User State는 접근 허용의 최상위 게이트로 동작한다.

- deleted → 모든 접근 불가 (계정 비활성/삭제 처리)
- suspended → 서비스 이용 제한 (정책에 정의된 최소 접근만 허용 가능)
- guest → 제한된 체험/읽기 범위만 허용
- member → 정상 이용

> 즉, **Platform Authority가 있더라도 suspended/deleted 상태에서는 제한이 우선 적용 **

---

## **3. Platform Authority 정책**

### **3.1 super_admin 정책**

### **3.1.1 운영 범위 및 데이터 접근**

- super_admin은 **운영 목적의 범위 내에서 모든 데이터에 접근**할 수 있다.
- 개인정보·민감정보는 기본적으로 마스킹된 상태로 제공된다.
- 민감정보의 **전체 열람이 필요한 경우**, 해당 행위는 반드시 **감사 로그(Audit Log)** 에 기록된다.

### **3.1.2 관리자(Authority) 관리**

- super_admin은 **admin을 임명/해제**할 수 있다.
- super_admin은 플랫폼 운영 정책 및 운영 기능 설정을 변경할 수 있다.
- super_admin은 admin이 수행할 수 있는 모든 권한을 포함하며 이를 상회한다.

### **3.1.3 super_admin 유지 규칙**

- super_admin은 복수를 허용한다.
- 플랫폼에는 **항상 최소 1명의 super_admin이 존재**해야 한다.
- 마지막 super_admin은 스스로 권한을 포기할 수 없다.
- super_admin이 권한을 내려놓고자 할 경우, **다른 super_admin을 먼저 지정**해야 한다.

### **3.1.4 초기 super_admin 지정**

- 서비스 초기 배포 시점에 **1명의 super_admin이 부트스트랩 방식으로 지정**된다.
- 해당 super_admin은 플랫폼 운영 책임자로서 초기 권한을 가진다. (초기 지정자: 사용자 본인)

---

### **3.2 admin 정책**

### **3.2.1 접근 범위**

- admin은 플랫폼 관리자 페이지에 접근할 수 있다.
- admin은 운영 목적의 범위 내에서 운영 기능을 수행할 수 있다.

### **3.2.2 운영 권한(허용 리스트, v0)**

admin은 아래 운영 행위를 수행할 수 있다.

- 사용자 신고 처리
- 콘텐츠 숨김 및 차단
- 공지사항 작성/게시/관리
- 고객 지원(CS) 대응 및 운영 처리
- 부적절한 사용에 대한 사용자 제재
    - 일시 정지(suspend)
    - 이용 제한(기능 제한/접근 제한)

> 제재 사유 및 제재 기간은 내부 운영 기준에 따라 결정된다.

### **3.2.3 제한 사항 (명시적 금지)**

- admin은 **사용자 계정 삭제(탈퇴 처리)** 를 수행할 수 없다.
- admin은 사용자 개인정보의 **삭제** 권한을 가지지 않는다.
- admin은 super_admin의 임명/해제를 수행할 수 없다.
- admin의 민감정보 접근은 제한되며, 필요한 경우 감사 로그를 남긴다.

---

## **4. User State 정책**

### **4.1 guest**

- guest는 로그인하지 않은 방문자 상태이다.
- guest는 서비스의 제한된 체험/읽기 범위 내에서만 기능을 이용할 수 있다.

### **4.2 pending**

- pending은 소셜 로그인은 완료했으나, 필수 약관 동의 등 가입 절차를 마무리하지 않은 상태이다.
- pending 상태에서는 대시보드 접근 등 주요 기능 이용이 제한되며, 가입 페이지로 리다이렉트된다.

### **4.3 active (ex. member)**

- active는 가입 절차가 모두 완료되어 정상적으로 서비스를 이용할 수 있는 상태이다.
- active 사용자는 본인 계정에 대한 **탈퇴(삭제 요청)** 를 할 수 있다.
- 초기 정책에서는 탈퇴 요청 시 **즉시 계정 삭제**가 수행된다.

### **4.3 suspended**

- suspended는 부적절한 사용으로 인해 서비스 이용이 제한된 상태이다.
- admin 및 super_admin은 내부 운영 기준에 따라 사용자를 suspended 처리할 수 있다.
- suspended의 제재 기간 및 사유는 내부 규칙에 따라 결정되며, 필요 시 해제할 수 있다.

### **4.4 deleted**

- deleted는 탈퇴 처리된 상태이다.
- deleted 상태의 계정은 서비스 접근이 불가능하다.
- 초기 정책에서는 “즉시 삭제”가 원칙이며, 향후 결제 도입 시 일부 데이터 보관/비식별화 정책이 추가될 수 있다.

---

## **5. Workspace Role 정책**

### **5.1 owner**

- owner는 해당 워크스페이스의 최고 권한자이다.
- owner는 워크스페이스의 멤버를 **초대**할 수 있다.
- owner는 워크스페이스의 멤버를 **추방(제거)** 할 수 있다.
- owner는 워크스페이스 운영에 필요한 설정을 변경할 수 있다. (구체 항목은 제품 기능 범위에 따라 확장)

### **5.2 member**

- member는 초대를 수락하거나 워크스페이스에 배정됨으로써 해당 워크스페이스의 기능을 이용할 수 있다.
- member는 owner의 권한(초대/추방/핵심 설정 변경)을 수행할 수 없다.

---

## **6. 데이터 삭제 및 비식별화 정책**

- 초기 서비스 단계에서는 결제/회계 등으로 인해 삭제가 제한되는 데이터는 없으며, **탈퇴 시 즉시 삭제**를 원칙으로 한다.
- **4. Data Integrity (Cascade Deletion)**
    - 사용자 삭제(`public.users` 레코드 삭제) 시, 해당 사용자의 권한(`workspace_members`)은 **Cascade** 설정에 의해 자동 삭제된다.
    - 워크스페이스의 마지막 멤버가 삭제되면, 해당 워크스페이스(고아 데이터)는 **Trigger**에 의해 자동으로 삭제된다.
- 향후 결제 기능이 도입될 경우, 법적·회계적 사유로 인해 결제 관련 데이터 등 일부는 **삭제가 제한**될 수 있으며, 이 경우 **비식별화 또는 마스킹** 처리 정책을 별도로 정의한다.

---

## **7. 감사 로그 (Audit Log)**

다음 행위는 반드시 감사 로그에 기록된다.

- Platform Authority 변경 (super_admin/admin 임명 및 해제)
- 사용자 제재(suspend/제한) 및 해제
- 민감 데이터 접근 및 열람
- 운영 설정 변경 (플랫폼/콘텐츠 정책/운영 기능 등)

감사 로그는 운영 투명성 및 보안 강화를 목적으로 하며, 임의 삭제를 허용하지 않는다.

---

## **8. 콘텐츠 정책 (향후 확장 지점)**

- 콘텐츠 허용 범위(예: 음란물, 불법 콘텐츠, 혐오/폭력, 저작권 침해 등)는
    
    서비스 성장 단계에 따라 별도의 **콘텐츠 정책(Content Policy)** 으로 정의한다.
    
- 운영 권한(허용 리스트)은 기능 확장 및 위험도에 따라 단계적으로 보강한다.